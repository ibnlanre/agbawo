/*!
 * Ã€gbawo-1.0.4
 * Copyright (c) 2020 Ridwan Olanrewaju.
 * Licensed under the MIT license.
 */
!(function (n, t) {
  "object" == typeof exports && "undefined" != typeof module
    ? (module.exports = t())
    : "function" == typeof define && define.amd
    ? define(t)
    : ((n =
        "undefined" != typeof globalThis
          ? globalThis
          : n || self).Agbawo = t());
})(this, function () {
  "use strict";
  var n = function (n) {
      return (
        "object" != typeof n ||
        null === n ||
        "function" == typeof n.toJSON ||
        n instanceof String ||
        n instanceof Number ||
        n instanceof RegExp ||
        n instanceof Date ||
        n instanceof Boolean
      );
    },
    t = "~",
    e = function (n) {
      return "string" == typeof n && 0 === n.indexOf("~~");
    },
    r = function (n) {
      return "string" == typeof n && 0 === n.indexOf(t) && !e(n);
    },
    o = function (n) {
      return r(n) || e(n) ? t + n : n;
    },
    i = function (n) {
      return n.slice(1);
    },
    u = function (n, t) {
      return (null == n ? void 0 : n.constructor.name) === t;
    },
    c = function (n) {
      var t = n[0],
        e = n[1];
      return t.split(/\b\.\b/).reduceRight(function (n, t) {
        var e;
        return ((e = {})[t] = n), e;
      }, e);
    },
    f = function (n, t) {
      return n.filter(function (n) {
        return u(n, t);
      });
    },
    a = function (n) {
      return n.replace(/"/g, "").substring(4);
    },
    s = function (n) {
      return (n.name ? n.name + "=" : "") + n;
    };
  function l(n, t, e) {
    return JSON.stringify(
      n,
      t ||
        function (n, t) {
          return t
            ? n && t instanceof RegExp
              ? "_re_" + ("/" + (e = t).source + "/" + (/\w+$/.exec(e) || ""))
              : t instanceof Function
              ? "_fn_" + s(t)
              : "symbol" == typeof t
              ? "_sm_" + t.toString()
              : ("Object" === t.constructor.name &&
                  Reflect.ownKeys(t).forEach(function (n) {
                    "symbol" == typeof n && (t["_sm_" + n.toString()] = t[n]);
                  }),
                t)
            : t;
          var e;
        },
      e
    );
  }
  function p(n, t, e) {
    var r = Object.getPrototypeOf(n);
    Reflect.ownKeys(r)
      .filter(function (n) {
        return !(n in t);
      })
      .concat(Reflect.ownKeys(n))
      .forEach(function (r) {
        return (function (r) {
          var o = Object.getOwnPropertyDescriptor(t, r);
          (r in t && !o.writable) ||
            (t[r] = Array.isArray(n[r])
              ? n[r].map(function (n) {
                  return y(n, e);
                })
              : y(n[r], e));
        })(r);
      });
  }
  function y(n, t) {
    void 0 === t && (t = new Map());
    try {
      if (t.has(n)) return t.get(n);
      if (!(n && n instanceof Object)) return n;
      var e = v(n);
      return p(n, e, t.set(n, e)), e;
    } catch (t) {
      return n;
    }
  }
  var v = function (n) {
      var t = n.constructor.name,
        e = global.Buffer && Buffer.isBuffer(n),
        r = [n.buffer, n.byteOffset, n.length];
      return "ArrayBuffer" === t
        ? n.slice()
        : "Date" === t
        ? new Date().setTime(n.getTime())
        : "RegExp" === t
        ? new RegExp(n.source, /\w+$/.exec(n) || "")
        : "buffer" in n
        ? (e ? Buffer.from : new n.constructor()).apply(void 0, r)
        : n instanceof Function
        ? new Function("return (" + s(n) + ")")()
        : new n.constructor();
    },
    d = (function () {
      function n() {
        (this.keys = []), (this.values = []);
      }
      return (
        (n.prototype.get = function (n) {
          var t = this.keys.indexOf(n);
          return this.values[t];
        }),
        (n.prototype.has = function (n) {
          return this.keys.indexOf(n) >= 0;
        }),
        (n.prototype.set = function (n, t) {
          var e = this.keys.indexOf(n);
          return (
            e >= 0
              ? (this.values[e] = t)
              : (this.keys.push(n), this.values.push(t)),
            this
          );
        }),
        n
      );
    })();
  var g = function (n, t) {
    if (n.length !== t.length) return !1;
    for (var e = 0; e < n.length; e++) if (n[e] !== t[e]) return !1;
    return !0;
  };
  var h = function () {
      for (var n = [], t = 0; t < arguments.length; t++) n[t] = arguments[t];
      var e = {};
      return (
        n.forEach(function (n) {
          for (var t in n) {
            var r = n.hasOwnProperty(t) && u(n[t], "Object");
            e[t] = r ? h(e[t], n[t]) : n[t];
          }
        }),
        e
      );
    },
    m = function (n) {
      return h.apply(void 0, Object.entries(n).map(c));
    },
    b = function (n, t, e) {
      for (var r in (void 0 === e && (e = {}), n)) {
        var o = t ? t + "." + r : r;
        u(n[r], "Object") ? b(n[r], o, e) : (e[o] = n[r]);
      }
      return e;
    },
    O = function (n, t, e) {
      return (
        void 0 === t && (t = 1 / 0),
        void 0 === e && (e = 1),
        n.reduce(function (n, r) {
          var o = Array.isArray(r) && e < t;
          return n.concat(o ? O(r, t, ++e) : r);
        }, [])
      );
    },
    w = function (n) {
      var t = function (n) {
        return new RegExp("\\s*" + n + "\\s*");
      };
      return (function (n) {
        return n.split(t(";")).filter(Boolean);
      })(n.trim())
        .map(function (n) {
          return n.split(t(":"));
        })
        .map(c);
    };
  return {
    clone: y,
    stringify: function (u, c, f) {
      var a = (function (e) {
          var r = [],
            i = new d(),
            u = function (e, c) {
              var f = e;
              return (
                n(e) ||
                  (i.has(e)
                    ? (i.get(e) instanceof Array &&
                        (r.push(i.get(e)),
                        i.set(e, String(t + (r.length - 1)))),
                      (f = i.get(e)))
                    : (i.set(e, c),
                      (f = Reflect.ownKeys(e).reduce(
                        function (n, t) {
                          return (n[t] = u(e[t], c.concat(t))), n;
                        },
                        e instanceof Array ? [] : {}
                      )))),
                "string" == typeof e && (f = o(e)),
                f
              );
            };
          return { legend: r, main: u(e, []) };
        })(u),
        s = l(a.legend),
        p = l(
          a.main,
          (function (n) {
            return "function" != typeof n
              ? n
              : function (t, u) {
                  return e(u) ? o(n(t, i(u))) : r(u) ? u : n(t, u);
                };
          })(c),
          f
        );
      return void 0 !== p ? '{"legend":' + s + ',"main":' + p + "}" : p;
    },
    parse: function (t, u) {
      return (
        (c = (function (n, t) {
          var e = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;
          try {
            return JSON.parse(
              n,
              t ||
                function (n, t) {
                  return "string" != typeof t
                    ? t
                    : t.match(e)
                    ? new Date(t)
                    : t.startsWith("_fn_") || t.startsWith("_re_")
                    ? new Function("return " + a(t))()
                    : t.startsWith("_sm_")
                    ? Symbol.for("" + /\((\w+)\)/.exec(a(t))[1])
                    : t;
                }
            );
          } catch (n) {
            console.log(n);
          }
        })(
          t,
          (function (n) {
            return "function" != typeof n
              ? n
              : function (t, u) {
                  return e(u) ? o(n(t, i(u))) : r(u) ? u : n(t, u);
                };
          })(u)
        )),
        (f = function (t, o, u) {
          var s,
            l = t;
          return (
            t &&
              "Object" === t.constructor.name &&
              Object.keys(t).forEach(function (n) {
                "string" == typeof n &&
                  n.startsWith("_sm_") &&
                  (((l = c.main)[Symbol.for("" + /\((\w+)\)/.exec(a(n))[1])] =
                    t[n]),
                  delete l[n]);
              }),
            n(t) ||
              Reflect.ownKeys(t).forEach(function (n) {
                return f(t[n], n, t);
              }),
            r(t) &&
              ((l = c.main),
              (s = Number(i(t))),
              c.legend[s].forEach(function (n) {
                return (l = l[n]);
              })),
            e(t) && (l = i(t)),
            u && (u[o] = l),
            l
          );
        }),
        "object" == typeof c &&
        null !== c &&
        void 0 !== c.main &&
        void 0 !== c.legend &&
        c.legend instanceof Array
          ? f(c.main)
          : c
      );
      var c, f;
    },
    inspect: function (n) {
      return Reflect.ownKeys(Object.getPrototypeOf(n))
        .concat(Reflect.ownKeys(n))
        .reduce(function (t, e) {
          return (t[e] = n[e]), t;
        }, {});
    },
    memoize: function (n, t) {
      var e;
      void 0 === t && (t = g);
      var r,
        o = [],
        i = !1;
      return function () {
        for (var u, c = [], f = 0; f < arguments.length; f++)
          c[f] = arguments[f];
        var a = i && e === this;
        return (
          (a && t(c, o)) ||
            ((r = n.apply(this, c)),
            (i = (u = [!0, this, c])[0]),
            (e = u[1]),
            (o = u[2])),
          r
        );
      };
    },
    flatten: b,
    unflatten: m,
    deflate: O,
    merge: h,
    hydrate: w,
    combine: function () {
      for (var n = [], t = 0; t < arguments.length; t++) n[t] = arguments[t];
      var e = f(n, "Object"),
        r = O(f(n, "String").map(w));
      return h.apply(void 0, e.map(m).concat(r));
    },
    refresh: function (n, t) {
      void 0 === t && (t = {});
      var e = Object.assign({ retain: [], remove: [], restock: {} }, t);
      return (
        Object.keys(n).forEach(function (t) {
          if (e.remove.length) {
            if (!e.remove.includes(t)) return;
            delete n[t];
          }
          e.retain.includes(t) || delete n[t];
        }),
        Object.entries(e.restock || {}).reduce(function (n, t) {
          var e = t[0],
            r = t[1];
          return (n[e] = r), n;
        }, n),
        n
      );
    },
  };
});
